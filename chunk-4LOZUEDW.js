import{B as C,D as X,G as Y,K as z,a as _,b as m,c as w,d as k,e as u,g,i as l,j as b,k as p,m as x,n as v,o as S,p as B,q as I,r as n,s,t as c,u as y,v as h,w as d,y as f}from"./chunk-TMVHNRXW.js";var A=(()=>{let e=class e{static get Instance(){return e._Instance}constructor(t,i){this.platformId=t,this.doc=i,this.isInBrowser=Y(this.platformId),e._Instance=this}get IsInMobile(){let t=this.getWindow?.navigator?.userAgent||this.getWindow?.navigator?.vendor;return t?/android/i.test(t)||/iPhone|ipad|iPod/i.test(t):!1}get IsInBrowser(){return this.isInBrowser}get getWindow(){return this.doc.defaultView}get getDocument(){return this.doc}};e.\u0275fac=function(i){return new(i||e)(m(g),m(X))},e.\u0275prov=_({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();function j(o,e){if(o&1){let r=y();n(0,"div",6)(1,"h1",9),f(2," Game Over "),s(),n(3,"button",10),h("click",function(){k(r);let i=d();return u(i.reloadGame())}),f(4," Reload "),s()()}}function O(o,e){if(o&1){let r=y();n(0,"div",11)(1,"button",12),h("click",function(){let i=k(r).$implicit,a=d(2);return u(a.handleDirection(i.name))}),c(2,"span"),s()()}if(o&2){let r=e.$implicit;l(2),x(r.icon+" text-[4rem] text-[#B1B9D8]")}}function F(o,e){if(o&1&&(n(0,"div",8),B(1,O,3,2,"div",11,S),s()),o&2){let r=d();l(),I(r.mobileControllers)}}var P=(()=>{let e=class e{constructor(t,i){this._router=t,this._localRepository=i,this.blockSize=10,this.rows=35,this.cols=35,this.snakeX=this.blockSize*5,this.snakeY=this.blockSize*5,this.snakeBody=[],this.velocityX=0,this.velocityY=0,this.foodX=0,this.foodY=0,this.speed=5,this.gameOver=!1,this.mobileControllers=[{name:"ArrowUp",icon:"icon arrow-circle-up"},{name:"ArrowDown",icon:"icon arrow-circle-down"},{name:"ArrowLeft",icon:"icon arrow-circle-left"},{name:"ArrowRight",icon:"icon arrow-circle-right"}],this.isMobile=i.IsInMobile}ngAfterViewInit(){this._initGame(),this._starter()}_initGame(){this.board=document.getElementById("board"),this.board&&(this.board.height=this.rows*this.blockSize,this.board.width=this.cols*this.blockSize,this.context=this.board.getContext("2d")),this._placeFood(),this._detectChangeDirection()}_starter(){this.interval=setInterval(()=>this._update(),1e3/this.speed)}_detectChangeDirection(){this._localRepository.IsInMobile||document.addEventListener("keyup",t=>{switch(t.code){case"Space":clearInterval(this.interval);break;default:this.handleDirection(t.code);break}})}handleDirection(t){switch(t){case"ArrowUp":this.velocityY!==1&&(this.velocityX=0,this.velocityY=-1);break;case"ArrowDown":this.velocityY!==-1&&(this.velocityX=0,this.velocityY=1);break;case"ArrowLeft":this.velocityX!==1&&(this.velocityX=-1,this.velocityY=0);break;case"ArrowRight":this.velocityX!==-1&&(this.velocityX=1,this.velocityY=0);break;default:this.velocityX=0,this.velocityY=0;break}}_update(){if(!this.gameOver){this.context.fillStyle="#1A2036",this.context.fillRect(0,0,this.board.width,this.board.height),this.context.fillStyle="#7F88A9",this.context.fillRect(this.foodX,this.foodY,this.blockSize,this.blockSize),this._snakeAteFood()&&(this.snakeBody.push([this.foodX,this.foodY]),this._placeFood());for(let t=this.snakeBody.length-1;t>0;t--)this.snakeBody[t]=this.snakeBody[t-1];this.snakeBody.length&&(this.snakeBody[0]=[this.snakeX,this.snakeY]),this.context.fillStyle="#B1B9D8",this.snakeX+=this.velocityX*this.blockSize,this.snakeY+=this.velocityY*this.blockSize,this.context.fillRect(this.snakeX,this.snakeY,this.blockSize,this.blockSize),this._drowSnakeBody(),this._checkGameOver()}}_checkGameOver(){(this.snakeX<0||this.snakeX>this.cols*this.blockSize||this.snakeY<0||this.snakeY>this.rows*this.blockSize)&&this._setGameOver();for(let t=0;t<this.snakeBody.length;t++)this.snakeX===this.snakeBody[t][0]&&this.snakeY===this.snakeBody[t][1]&&this._setGameOver()}_setGameOver(){this.context.clearRect(0,0,this.board.width,this.board.height),this.gameOver=!0,this.snakeBody=[],this.snakeY=this.blockSize*5,this.snakeX=this.blockSize*5,clearInterval(this.interval)}_drowSnakeBody(){for(let t=0;t<this.snakeBody.length;t++)this.context.fillRect(this.snakeBody[t][0],this.snakeBody[t][1],this.blockSize,this.blockSize)}_snakeAteFood(){return this.snakeX===this.foodX&&this.snakeY===this.foodY}_placeFood(){this.foodX=Math.floor(Math.random()*(this.cols-1))*this.blockSize,this.foodY=Math.floor(Math.random()*(this.rows-1))*this.blockSize}goBack(){this._router.navigate(["/"])}reloadGame(){this.gameOver=!1,this._initGame(),this.handleDirection(""),this._starter()}};e.\u0275fac=function(i){return new(i||e)(b(z),b(A))},e.\u0275cmp=w({type:e,selectors:[["app-snake"]],standalone:!0,features:[C],decls:10,vars:2,consts:[[1,"bg-[#2E3650]","flex","flex-wrap","justify-center","text-center","h-[100dvh]","content-between"],[1,"flex","w-full","items-center","justify-between","p-4","border-b-2","border-gray-400","border-opacity-20"],[1,"text-gray-100",3,"click"],[1,"icon","arrow-left","text-2xl"],[1,"text-3xl","text-gray-100","font-bold"],[1,"flex","flex-wrap","w-full","content-center","justify-center","h-[calc(100dvh-70px)]","relative"],[1,"absolute","top-0","left-0","w-full","h-full","flex","flex-wrap","items-center","justify-center","content-center","bg-red-300"],["id","board"],[1,"w-full","mt-4","grid","grid-cols-4","gap-4"],[1,"w-full","text-center","text-3xl","text-gray-100","font-bold"],[1,"mt-4","text-white","border-2","py-2","px-4","border-gray-100",3,"click"],[1,"flex","justify-center"],[1,"flex","items-center","justify-center",3,"click"]],template:function(i,a){i&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),h("click",function(){return a.goBack()}),c(3,"span",3),s(),n(4,"h1",4),f(5,"Snake"),s()(),n(6,"div",5),p(7,j,5,0,"div",6),c(8,"canvas",7),p(9,F,3,0,"div",8),s()()),i&2&&(l(7),v(7,a.gameOver?7:-1),l(2),v(9,a.isMobile?9:-1))}});let o=e;return o})();export{P as SnakeComponent};
