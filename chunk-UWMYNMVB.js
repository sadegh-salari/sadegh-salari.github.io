import{B as w,C as _,E as I,F as C,K as k,c,d as m,e as g,i as n,j as b,k as y,l as f,n as u,r as a,s as h,t as o,u as v,v as d,w as x,y as l}from"./chunk-TMVHNRXW.js";var P=i=>({"game-over":i});function F(i,r){if(i&1){let H=v();a(0,"div",7)(1,"button",8),d("click",function(){m(H);let e=x();return g(e.startGame())}),l(2," Start "),h()()}}var W=(()=>{let r=class r{constructor(t){this._router=t,this.boardWidth=375,this.boardHeight=595,this.birdWidth=34,this.birdHeight=24,this.birdX=this.boardWidth/8,this.birdY=this.boardHeight/2,this.pipeArray=[],this.pipeWidth=62,this.pipeHeight=512,this.pipeX=this.boardWidth,this.pipeY=0,this.velocityX=-2,this.velocityY=0,this.gravity=.2,this.gameOver=!1,this.score=0,this.animationFrameId=0,this.gameStarted=!1,this.bird={x:this.birdX,y:this.birdY,width:this.birdWidth,height:this.birdHeight}}ngAfterViewInit(){this.board=document.getElementById("board"),this.board.height=this.boardHeight,this.board.width=this.boardWidth,this.context=this.board.getContext("2d"),this.birdImage=new Image,this.birdImage.src="../../../assets/flappy-bird/flappy-bird-icon.png",this.birdImage.onload=()=>{this.context.drawImage(this.birdImage,this.birdX,this.birdY,this.birdWidth,this.birdHeight)},this.topPipeImage=new Image,this.topPipeImage.src="../../../assets/flappy-bird/flappy-bird-pipe-top.png",this.bottomPipeImage=new Image,this.bottomPipeImage.src="../../../assets/flappy-bird/flappy-bird-pipe-bottom.png"}startGame(){this.gameOver=!1,this.gameStarted=!0,this.velocityX=-2,this.velocityY=0,this.animationFrameId=requestAnimationFrame(()=>this._update()),this.gameInterval=setInterval(()=>{this.gameOver||this._generatePipe()},1500),this.clickHandller||(this.clickHandller=document.addEventListener("click",()=>{this.velocityY=-4}))}_update(){if(console.log("_update"),this.animationFrameId=requestAnimationFrame(()=>this._update()),this.gameOver){this._resetGamePhysics();return}for(this.context.clearRect(0,0,this.board.width,this.board.height),this.velocityY+=this.gravity,this.bird.y=Math.max(this.bird.y+this.velocityY,0),this.context.drawImage(this.birdImage,this.bird.x,this.bird.y,this.bird.width,this.bird.height),this.bird.y>this.board.height&&(this.gameOver=!0),this.pipeArray.forEach(t=>{t.x+=this.velocityX,this.context.drawImage(t.img,t.x,t.y,t.width,t.height),!t.passed&&this.bird.x>t.x+t.width&&(t.passed=!0,this.score+=.5),this._detectCollision(this.bird,t)&&(this.gameOver=!0)});this.pipeArray.length>0&&this.pipeArray[0].x<-this.pipeWidth;)this.pipeArray.shift();this.context.fillStyle="white",this.context.font="30px Verdana",this.context.fillText(this.score,20,50)}_generatePipe(){if(this.gameOver){this._resetGamePhysics();return}let t=this.pipeY-this.pipeHeight/4-Math.random()*(this.pipeHeight/2),e=this.boardHeight/4,s={x:this.pipeX,y:t,img:this.topPipeImage,width:this.pipeWidth,height:this.pipeHeight,passed:!1};this.pipeArray.push(s);let p={x:this.pipeX,y:t+this.pipeHeight+e,img:this.bottomPipeImage,width:this.pipeWidth,height:this.pipeHeight,passed:!1};this.pipeArray.push(p)}_detectCollision(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}_resetGamePhysics(){this.velocityX=-2,this.velocityY=0,this.gravity=.4,this.bird.y=this.birdY,this.pipeArray=[],this.score=0,document.removeEventListener("click",this.clickHandller,!0),clearInterval(this.gameInterval),cancelAnimationFrame(this.animationFrameId),console.log("reset game")}goBack(){this._router.navigate(["/"])}};r.\u0275fac=function(e){return new(e||r)(b(k))},r.\u0275cmp=c({type:r,selectors:[["app-flappy-bird"]],standalone:!0,features:[w],decls:9,vars:4,consts:[[1,"bg-[#2E3650]","flex","flex-wrap","justify-center","text-center","h-[100dvh]","content-between"],[1,"flex","w-full","items-center","justify-between","p-4","border-b-2","border-gray-400","border-opacity-20"],[1,"text-gray-100",3,"click"],[1,"icon","arrow-left","text-2xl"],[1,"text-3xl","text-gray-100","font-bold"],[1,"flex","flex-wrap","w-full","content-center","justify-center","h-[calc(100dvh-70px)]","relative"],["id","board",3,"ngClass"],[1,"w-full","absolute","top-[50%]","flex","items-center","justify-center"],[1,"text-white","border-2","py-2","px-4","border-gray-100","rounded-xl",3,"click"]],template:function(e,s){e&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),d("click",function(){return s.goBack()}),o(3,"span",3),h(),a(4,"h1",4),l(5,"Flappy Bird"),h()(),a(6,"div",5),o(7,"canvas",6),y(8,F,3,0,"div",7),h()()),e&2&&(n(7),f("ngClass",_(2,P,s.gameOver)),n(),u(8,s.gameOver||!s.gameStarted?8:-1))},dependencies:[C,I],styles:['#board[_ngcontent-%COMP%]{background-image:url("./media/bg-2CHF5NNO.jpg");background-size:cover;background-position:center center;background-repeat:no-repeat}.game-over[_ngcontent-%COMP%]{filter:grayscale(1)}']});let i=r;return i})();export{W as FlappyBirdComponent};
